!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.algoliasearchHelper=e()}}(function(){return function e(t,i,s){function n(a,c){if(!i[a]){if(!t[a]){var u="function"==typeof require&&require;if(!c&&u)return u(a,!0);if(r)return r(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var f=i[a]={exports:{}};t[a][0].call(f.exports,function(e){var i=t[a][1][e];return n(i?i:e)},f,f.exports,e,t,i,s)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<s.length;a++)n(s[a]);return n}({1:[function(e,t){function i(e,t,i){return new s(e,t,i)}var s=e("./src/algoliasearch.helper");t.exports=i},{"./src/algoliasearch.helper":2}],2:[function(e,t){"use strict";function i(e,t,i){var n={facets:[],disjunctiveFacets:[],hitsPerPage:20,defaultFacetFilters:[]};this.init(e,t,s({},n,i))}var s=e("./functions/extend");i.prototype={constructor:i,init:function(e,t,i){this.client=e,this.index=t,this.options=i,this.page=0,this.refinements={},this.excludes={},this.disjunctiveRefinements={},this.extraQueries=[]},search:function(e,t,i){this.q=e,this.searchCallback=t,this.searchParams=i||{},this.page=this.page||0,this.refinements=this.refinements||{},this.disjunctiveRefinements=this.disjunctiveRefinements||{},this._search()},clearRefinements:function(){this.disjunctiveRefinements={},this.refinements={}},addDisjunctiveRefine:function(e,t){this.disjunctiveRefinements=this.disjunctiveRefinements||{},this.disjunctiveRefinements[e]=this.disjunctiveRefinements[e]||{},this.disjunctiveRefinements[e][t]=!0},removeDisjunctiveRefine:function(e,t){this.disjunctiveRefinements=this.disjunctiveRefinements||{},this.disjunctiveRefinements[e]=this.disjunctiveRefinements[e]||{};try{delete this.disjunctiveRefinements[e][t]}catch(i){this.disjunctiveRefinements[e][t]=void 0}},addRefine:function(e,t){var i=e+":"+t;this.refinements=this.refinements||{},this.refinements[i]=!0},removeRefine:function(e,t){var i=e+":"+t;this.refinements=this.refinements||{},this.refinements[i]=!1},addExclude:function(e,t){var i=e+":-"+t;this.excludes=this.excludes||{},this.excludes[i]=!0},removeExclude:function(e,t){var i=e+":-"+t;this.excludes=this.excludes||{},this.excludes[i]=!1},toggleExclude:function(e,t){for(var i=0;i<this.options.facets.length;++i)if(this.options.facets[i]===e){var s=e+":-"+t;return this.excludes[s]=!this.excludes[s],this.page=0,this._search(),!0}return!1},toggleRefine:function(e,t){for(var i=0;i<this.options.facets.length;++i)if(this.options.facets[i]===e){var s=e+":"+t;return this.refinements[s]=!this.refinements[s],this.page=0,this._search(),!0}this.disjunctiveRefinements[e]=this.disjunctiveRefinements[e]||{};for(var n=0;n<this.options.disjunctiveFacets.length;++n)if(this.options.disjunctiveFacets[n]===e)return this.disjunctiveRefinements[e][t]=!this.disjunctiveRefinements[e][t],this.page=0,this._search(),!0;return!1},isRefined:function(e,t){var i=e+":"+t;return this.refinements[i]?!0:this.disjunctiveRefinements[e]&&this.disjunctiveRefinements[e][t]?!0:!1},isExcluded:function(e,t){var i=e+":-"+t;return this.excludes[i]?!0:!1},nextPage:function(){this._gotoPage(this.page+1)},previousPage:function(){this.page>0&&this._gotoPage(this.page-1)},gotoPage:function(e){this._gotoPage(e)},setPage:function(e){this.page=e},setIndex:function(e){this.index=e},getIndex:function(){return this.index},clearExtraQueries:function(){this.extraQueries=[]},addExtraQuery:function(e,t,i){this.extraQueries.push({index:e,query:t,params:i||{}})},_gotoPage:function(e){this.page=e,this._search()},_search:function(){this.client.startQueriesBatch(),this.client.addQueryInBatch(this.index,this.q,this._getHitsSearchParams());var e=[],t={},i=0;for(i=0;i<this.options.disjunctiveFacets.length;++i){var s=this.options.disjunctiveFacets[i];this._hasDisjunctiveRefinements(s)?e.push(s):t[s]=!0}for(i=0;i<e.length;++i)this.client.addQueryInBatch(this.index,this.q,this._getDisjunctiveFacetSearchParams(e[i]));for(i=0;i<this.extraQueries.length;++i)this.client.addQueryInBatch(this.extraQueries[i].index,this.extraQueries[i].query,this.extraQueries[i].params);var n=this;this.client.sendQueriesBatch(function(s,r){if(s)return void n.searchCallback(new Error(r.message),r);var a=r.results[0];a.disjunctiveFacets=a.disjunctiveFacets||{},a.facetStats=a.facetStats||{};for(var c in t)if(a.facets[c]&&!a.disjunctiveFacets[c]){a.disjunctiveFacets[c]=a.facets[c];try{delete a.facets[c]}catch(u){a.facets[c]=void 0}}for(i=0;i<e.length;++i){for(var h in r.results[i+1].facets)if(a.disjunctiveFacets[h]=r.results[i+1].facets[h],n.disjunctiveRefinements[h])for(var f in n.disjunctiveRefinements[h])!a.disjunctiveFacets[h][f]&&n.disjunctiveRefinements[h][f]&&(a.disjunctiveFacets[h][f]=0);for(var o in r.results[i+1].facets_stats)a.facetStats[o]=r.results[i+1].facets_stats[o]}for(var d in n.excludes)if(n.excludes[d]){var l=d.indexOf(":-"),v=d.slice(0,l),g=d.slice(l+2);a.facets[v]=a.facets[v]||{},a.facets[v][g]||(a.facets[v][g]=0)}if(0===n.extraQueries.length)n.searchCallback(null,a);else{var m={results:[a]};for(i=0;i<n.extraQueries.length;++i)m.results.push(r.results[1+e.length+i]);n.searchCallback(null,m)}})},_getHitsSearchParams:function(){var e=[],t=0;for(t=0;t<this.options.facets.length;++t)e.push(this.options.facets[t]);for(t=0;t<this.options.disjunctiveFacets.length;++t){var i=this.options.disjunctiveFacets[t];this._hasDisjunctiveRefinements(i)||e.push(i)}return s({},{hitsPerPage:this.options.hitsPerPage,page:this.page,facets:e,facetFilters:this._getFacetFilters()},this.searchParams)},_getDisjunctiveFacetSearchParams:function(e){return s({},this.searchParams,{hitsPerPage:1,page:0,attributesToRetrieve:[],attributesToHighlight:[],attributesToSnippet:[],facets:e,facetFilters:this._getFacetFilters(e)})},_hasDisjunctiveRefinements:function(e){for(var t in this.disjunctiveRefinements[e])if(this.disjunctiveRefinements[e][t])return!0;return!1},_getFacetFilters:function(e){var t=[];if(this.options.defaultFacetFilters)for(var i=0;i<this.options.defaultFacetFilters.length;++i)t.push(this.options.defaultFacetFilters[i]);for(var s in this.refinements)this.refinements[s]&&t.push(s);for(var n in this.excludes)this.excludes[n]&&t.push(n);for(var r in this.disjunctiveRefinements)if(r!==e){var a=[];for(var c in this.disjunctiveRefinements[r])this.disjunctiveRefinements[r][c]&&a.push(r+":"+c);a.length>0&&t.push(a)}return t}},t.exports=i},{"./functions/extend":3}],3:[function(e,t){"use strict";t.exports=function(e){e=e||{};for(var t=1;t<arguments.length;t++)if(arguments[t])for(var i in arguments[t])arguments[t].hasOwnProperty(i)&&(e[i]=arguments[t][i]);return e}},{}]},{},[1])(1)});